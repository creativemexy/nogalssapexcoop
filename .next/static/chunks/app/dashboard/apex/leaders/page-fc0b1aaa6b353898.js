(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[895],{1686:function(e,t,a){Promise.resolve().then(a.bind(a,3857))},7648:function(e,t,a){"use strict";a.d(t,{default:function(){return l.a}});var s=a(2972),l=a.n(s)},3857:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return n}});var s=a(7437),l=a(2265),r=a(7648);function n(){let[e,t]=(0,l.useState)(""),[a,n]=(0,l.useState)([]),[c,i]=(0,l.useState)([]),[d,o]=(0,l.useState)([]),[x,m]=(0,l.useState)(!0),[u,p]=(0,l.useState)(null),[h,b]=(0,l.useState)(!1),[N,y]=(0,l.useState)(!1),[g,f]=(0,l.useState)(!1),[j,v]=(0,l.useState)(null),[k,w]=(0,l.useState)({firstName:"",lastName:"",phone:"",email:"",bankName:"",bankAccountNumber:"",bankAccountName:"",cooperative:""}),[A,C]=(0,l.useState)(!1),[S,L]=(0,l.useState)(null);(0,l.useEffect)(()=>{E(),B(),q()},[]);let E=async()=>{m(!0),p(null);try{let e=await fetch("/api/apex/leaders");if(!e.ok)throw Error("Failed to fetch leaders");let t=await e.json();n(t.leaders||[])}catch(e){p(e.message||"Unknown error")}finally{m(!1)}},B=async()=>{try{let e=await fetch("/api/cooperatives/list");if(e.ok){let t=await e.json();i(t.cooperatives||[])}}catch(e){console.error("Failed to fetch cooperatives:",e)}},q=async()=>{try{let e=await fetch("/api/banks/list");if(e.ok){let t=await e.json();o(t.banks||[])}}catch(e){console.error("Failed to fetch banks:",e)}},D=async e=>{e.preventDefault(),C(!0),L(null);try{let e=await fetch("/api/apex/leaders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to add leader");n(e=>[t.leader,...e]),b(!1),w({firstName:"",lastName:"",phone:"",email:"",bankName:"",bankAccountNumber:"",bankAccountName:"",cooperative:""})}catch(e){L(e.message||"Unknown error")}finally{C(!1)}},F=e=>{v(e),y(!0)},P=e=>{v(e),w({firstName:e.firstName,lastName:e.lastName,phone:e.phone,email:e.email,bankName:e.bankName,bankAccountNumber:e.bankAccountNumber,bankAccountName:e.bankAccountName,cooperative:e.cooperative}),f(!0)},_=async e=>{if(confirm("Are you sure you want to ".concat("Active"===e.status?"deactivate":"activate"," ").concat(e.firstName," ").concat(e.lastName,"?")))try{(await fetch("/api/apex/leaders/".concat(e.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:"Active"!==e.status})})).ok&&n(t=>t.map(t=>t.id===e.id?{...t,status:"Active"===t.status?"Inactive":"Active"}:t))}catch(e){console.error("Failed to update leader status:",e)}},O=a.filter(t=>t.firstName.toLowerCase().includes(e.toLowerCase())||t.lastName.toLowerCase().includes(e.toLowerCase())||t.email.toLowerCase().includes(e.toLowerCase())||t.phone.toLowerCase().includes(e.toLowerCase())||t.cooperative.toLowerCase().includes(e.toLowerCase()));return(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Leaders Management"}),(0,s.jsx)(r.default,{href:"/dashboard/apex",className:"text-[#0D5E42] hover:text-[#0A4A35]",children:"← Back to Apex Dashboard"})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("input",{type:"text",placeholder:"Search leaders...",value:e,onChange:e=>t(e.target.value),className:"border border-gray-300 rounded-md px-3 py-2 w-full max-w-xs focus:outline-none focus:ring-2 focus:ring-[#0D5E42]"}),(0,s.jsx)("button",{className:"ml-4 bg-[#0D5E42] text-white px-6 py-2 rounded hover:bg-[#0A4A35]",onClick:()=>b(!0),children:"+ Add New Leader"})]}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:x?(0,s.jsx)("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):u?(0,s.jsx)("div",{className:"p-8 text-center text-red-500",children:u}):(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"First Name"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Name"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bank Name"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bank Account Number"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bank Account Name"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cooperative"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===O.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:10,className:"px-6 py-4 text-center text-gray-500",children:"No leaders found."})}):O.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:e.firstName}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700",children:e.lastName}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700",children:e.phone}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700",children:e.email}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700",children:e.bankName}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700",children:e.bankAccountNumber}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700",children:e.bankAccountName}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700",children:e.cooperative}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("Active"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-500"),children:e.status})}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap space-x-2",children:[(0,s.jsx)("button",{className:"text-blue-600 hover:underline",onClick:()=>F(e),children:"View"}),(0,s.jsx)("button",{className:"text-yellow-600 hover:underline",onClick:()=>P(e),children:"Edit"}),(0,s.jsx)("button",{className:"text-red-600 hover:underline",onClick:()=>_(e),children:"Active"===e.status?"Deactivate":"Activate"})]})]},e.id))})]})}),h&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 w-full max-w-md relative",children:[(0,s.jsx)("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-600 text-2xl",onClick:()=>b(!1),"aria-label":"Close",children:"\xd7"}),(0,s.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Add New Leader"}),(0,s.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),(0,s.jsx)("input",{type:"text",value:k.firstName,onChange:e=>w(t=>({...t,firstName:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),(0,s.jsx)("input",{type:"text",value:k.lastName,onChange:e=>w(t=>({...t,lastName:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),(0,s.jsx)("input",{type:"text",value:k.phone,onChange:e=>w(t=>({...t,phone:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,s.jsx)("input",{type:"email",value:k.email,onChange:e=>w(t=>({...t,email:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Bank Name"}),(0,s.jsxs)("select",{value:k.bankName,onChange:e=>w(t=>({...t,bankName:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",required:!0,children:[(0,s.jsx)("option",{value:"",children:"Select a bank"}),d.map(e=>(0,s.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Bank Account Number"}),(0,s.jsx)("input",{type:"text",value:k.bankAccountNumber,onChange:e=>w(t=>({...t,bankAccountNumber:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Bank Account Name"}),(0,s.jsx)("input",{type:"text",value:k.bankAccountName,onChange:e=>w(t=>({...t,bankAccountName:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Cooperative"}),(0,s.jsxs)("select",{value:k.cooperative,onChange:e=>w(t=>({...t,cooperative:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",required:!0,children:[(0,s.jsx)("option",{value:"",children:"Select a cooperative"}),c.map(e=>(0,s.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),S&&(0,s.jsx)("div",{className:"text-red-600 text-sm",children:S}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-[#0D5E42] text-white px-6 py-2 rounded hover:bg-[#0A4A35] disabled:opacity-50",disabled:A,children:A?"Adding...":"Add Leader"})]})]})}),N&&j&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 w-full max-w-md relative",children:[(0,s.jsx)("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-600 text-2xl",onClick:()=>y(!1),"aria-label":"Close",children:"\xd7"}),(0,s.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Leader Details"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,s.jsxs)("p",{className:"mt-1 text-gray-900",children:[j.firstName," ",j.lastName]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),(0,s.jsx)("p",{className:"mt-1 text-gray-900",children:j.phone})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,s.jsx)("p",{className:"mt-1 text-gray-900",children:j.email})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Bank Name"}),(0,s.jsx)("p",{className:"mt-1 text-gray-900",children:j.bankName})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Bank Account Number"}),(0,s.jsx)("p",{className:"mt-1 text-gray-900",children:j.bankAccountNumber})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Bank Account Name"}),(0,s.jsx)("p",{className:"mt-1 text-gray-900",children:j.bankAccountName})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Cooperative"}),(0,s.jsx)("p",{className:"mt-1 text-gray-900",children:j.cooperative})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),(0,s.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("Active"===j.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-500"),children:j.status})]})]})]})})]})}}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=1686)}),_N_E=e.O()}]);