(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[68],{2330:function(e,s,t){Promise.resolve().then(t.bind(t,6887))},7648:function(e,s,t){"use strict";t.d(s,{default:function(){return l.a}});var a=t(2972),l=t.n(a)},9376:function(e,s,t){"use strict";var a=t(5475);t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})},6887:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return n}});var a=t(7437),l=t(7648),r=t(2265),i=t(9376);function n(){(0,i.useRouter)();let[e,s]=(0,r.useState)([]),[t,n]=(0,r.useState)(null),[c,d]=(0,r.useState)(!0),[o,x]=(0,r.useState)(""),[m,u]=(0,r.useState)("all"),[h,p]=(0,r.useState)("all"),[g,f]=(0,r.useState)(1),[v,y]=(0,r.useState)(1),[b,j]=(0,r.useState)("createdAt"),[N,w]=(0,r.useState)("desc"),[E,A]=(0,r.useState)([]),[k,S]=(0,r.useState)(""),[D,C]=(0,r.useState)(!1),[U,R]=(0,r.useState)(null);(0,r.useEffect)(()=>{P(),V()},[g,o,m,h,b,N]);let P=async()=>{try{d(!0);let e=new URLSearchParams({page:g.toString(),limit:"10",search:o,role:m,status:h,sortBy:b,sortOrder:N}),t=await fetch("/api/admin/users?".concat(e));if(t.ok){let e=await t.json();s(e.users),y(Math.ceil(e.total/10))}}catch(e){console.error("Error fetching users:",e)}finally{d(!1)}},V=async()=>{try{let e=await fetch("/api/admin/users/stats");if(e.ok){let s=await e.json();n(s)}}catch(e){console.error("Error fetching stats:",e)}},M=async(e,s)=>{try{(await fetch("/api/admin/users/".concat(e,"/").concat(s),{method:"PATCH"})).ok&&(P(),V())}catch(e){console.error("Error ".concat(s," user:"),e)}},I=async()=>{if(k&&0!==E.length)try{(await fetch("/api/admin/users/bulk-action",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({userIds:E,action:k})})).ok&&(A([]),S(""),P(),V())}catch(e){console.error("Error performing bulk action:",e)}},O=async()=>{if(U)try{(await fetch("/api/admin/users/".concat(U),{method:"DELETE"})).ok&&(C(!1),R(null),P(),V())}catch(e){console.error("Error deleting user:",e)}},T=e=>{A(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},_=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),B=e=>{switch(e){case"SUPER_ADMIN":return"bg-red-100 text-red-800";case"APEX":return"bg-purple-100 text-purple-800";case"LEADER":return"bg-blue-100 text-blue-800";case"COOPERATIVE":return"bg-green-100 text-green-800";case"MEMBER":default:return"bg-gray-100 text-gray-800";case"BUSINESS":return"bg-yellow-100 text-yellow-800"}};return c&&!e.length?(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#0D5E42]"})})}):(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Manage Users"}),(0,a.jsx)(l.default,{href:"/dashboard/super-admin",className:"text-[#0D5E42] hover:text-[#0A4A35]",children:"← Back to Dashboard"})]}),t&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:t.totalUsers})]}),(0,a.jsx)("div",{className:"text-3xl",children:"\uD83D\uDC65"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Users"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:t.activeUsers})]}),(0,a.jsx)("div",{className:"text-3xl",children:"✅"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Verified Users"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:t.verifiedUsers})]}),(0,a.jsx)("div",{className:"text-3xl",children:"\uD83D\uDD12"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Inactive Users"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:t.totalUsers-t.activeUsers})]}),(0,a.jsx)("div",{className:"text-3xl",children:"❌"})]})})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),(0,a.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:o,onChange:e=>x(e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#0D5E42]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),(0,a.jsxs)("select",{value:m,onChange:e=>u(e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#0D5E42]",children:[(0,a.jsx)("option",{value:"all",children:"All Roles"}),(0,a.jsx)("option",{value:"MEMBER",children:"Members"}),(0,a.jsx)("option",{value:"LEADER",children:"Leaders"}),(0,a.jsx)("option",{value:"APEX",children:"Apex"}),(0,a.jsx)("option",{value:"COOPERATIVE",children:"Cooperatives"}),(0,a.jsx)("option",{value:"BUSINESS",children:"Business"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,a.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#0D5E42]",children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"active",children:"Active"}),(0,a.jsx)("option",{value:"inactive",children:"Inactive"}),(0,a.jsx)("option",{value:"verified",children:"Verified"}),(0,a.jsx)("option",{value:"unverified",children:"Unverified"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort By"}),(0,a.jsxs)("select",{value:"".concat(b,"-").concat(N),onChange:e=>{let[s,t]=e.target.value.split("-");j(s),w(t)},className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#0D5E42]",children:[(0,a.jsx)("option",{value:"createdAt-desc",children:"Newest First"}),(0,a.jsx)("option",{value:"createdAt-asc",children:"Oldest First"}),(0,a.jsx)("option",{value:"firstName-asc",children:"Name A-Z"}),(0,a.jsx)("option",{value:"firstName-desc",children:"Name Z-A"}),(0,a.jsx)("option",{value:"email-asc",children:"Email A-Z"}),(0,a.jsx)("option",{value:"email-desc",children:"Email Z-A"})]})]})]})}),E.length>0&&(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-sm font-medium text-yellow-800",children:[E.length," user(s) selected"]}),(0,a.jsxs)("select",{value:k,onChange:e=>S(e.target.value),className:"border border-yellow-300 rounded-md px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-yellow-500",children:[(0,a.jsx)("option",{value:"",children:"Select Action"}),(0,a.jsx)("option",{value:"activate",children:"Activate"}),(0,a.jsx)("option",{value:"deactivate",children:"Deactivate"}),(0,a.jsx)("option",{value:"verify",children:"Verify"}),(0,a.jsx)("option",{value:"unverify",children:"Unverify"})]}),(0,a.jsx)("button",{onClick:I,disabled:!k,className:"bg-yellow-600 text-white px-4 py-1 rounded-md text-sm hover:bg-yellow-700 disabled:opacity-50",children:"Apply"})]}),(0,a.jsx)("button",{onClick:()=>{A([])},className:"text-yellow-600 hover:text-yellow-800 text-sm",children:"Clear Selection"})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,a.jsx)("input",{type:"checkbox",checked:E.length===e.length&&e.length>0,onChange:()=>{A(e.map(e=>e.id))},className:"rounded border-gray-300 text-[#0D5E42] focus:ring-[#0D5E42]"})}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cooperative"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("input",{type:"checkbox",checked:E.includes(e.id),onChange:()=>T(e.id),className:"rounded border-gray-300 text-[#0D5E42] focus:ring-[#0D5E42]"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,a.jsxs)("div",{className:"h-10 w-10 rounded-full bg-[#0D5E42] flex items-center justify-center text-white font-semibold",children:[e.firstName.charAt(0),e.lastName.charAt(0)]})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.firstName," ",e.lastName]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.email}),e.phoneNumber&&(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.phoneNumber})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(B(e.role)),children:e.role.replace("_"," ")})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.cooperative?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.cooperative.name}),(0,a.jsx)("div",{className:"text-gray-500",children:e.cooperative.registrationNumber})]}):(0,a.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"Active":"Inactive"}),(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.isVerified?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:e.isVerified?"Verified":"Unverified"})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_(e.createdAt)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>M(e.id,e.isActive?"deactivate":"activate"),className:"px-3 py-1 rounded-md text-xs ".concat(e.isActive?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"),children:e.isActive?"Deactivate":"Activate"}),(0,a.jsx)("button",{onClick:()=>M(e.id,e.isVerified?"unverify":"verify"),className:"px-3 py-1 rounded-md text-xs ".concat(e.isVerified?"bg-yellow-100 text-yellow-700 hover:bg-yellow-200":"bg-blue-100 text-blue-700 hover:bg-blue-200"),children:e.isVerified?"Unverify":"Verify"}),(0,a.jsx)("button",{onClick:()=>R(e.id),className:"px-3 py-1 rounded-md text-xs bg-red-100 text-red-700 hover:bg-red-200",children:"Delete"})]})})]},e.id))})]})}),v>1&&(0,a.jsxs)("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[(0,a.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,a.jsx)("button",{onClick:()=>f(e=>Math.max(1,e-1)),disabled:1===g,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>f(e=>Math.min(v,e+1)),disabled:g===v,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Next"})]}),(0,a.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing page ",(0,a.jsx)("span",{className:"font-medium",children:g})," of"," ",(0,a.jsx)("span",{className:"font-medium",children:v})]})}),(0,a.jsx)("div",{children:(0,a.jsx)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:Array.from({length:v},(e,s)=>s+1).map(e=>(0,a.jsx)("button",{onClick:()=>f(e),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium ".concat(e===g?"z-10 bg-[#0D5E42] border-[#0D5E42] text-white":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"),children:e},e))})})]})]})]}),D&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,a.jsxs)("div",{className:"mt-3 text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Delete User"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"Are you sure you want to delete this user? This action cannot be undone."}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)("button",{onClick:()=>C(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancel"}),(0,a.jsx)("button",{onClick:O,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Delete"})]})]})})})]})}}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=2330)}),_N_E=e.O()}]);